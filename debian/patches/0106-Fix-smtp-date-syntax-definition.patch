From: Vsevolod Stakhov <vsevolod@highsecure.ru>
Date: Mon, 5 Oct 2020 19:33:15 +0100
Applied-Upstream: https://github.com/rspamd/rspamd/commit/bce410d5688a5c493c6ba3e5d18a87e2720dfc65
Subject: Fix smtp date syntax definition

Suggested by: @citrin
---
 src/ragel/smtp_date.rl | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/src/ragel/smtp_date.rl b/src/ragel/smtp_date.rl
index 35ed749..90c34b9 100644
--- a/src/ragel/smtp_date.rl
+++ b/src/ragel/smtp_date.rl
@@ -180,13 +180,13 @@
   minute          =   digit_2;
   second          =   digit_2;
   time_of_day     =   hour >Hour_Start %Hour_End ":" minute >Minute_Start %Minute_End (":" second >Second_Start %Second_End )?;
-  zone            =   FWS ("+" | "-") %TZ_Sign digit_4 >TZ_Offset_Start %TZ_Offset_End;
+  zone            =   ("+" | "-") %TZ_Sign digit_4 >TZ_Offset_Start %TZ_Offset_End;
   obs_zone        =   "UT" %TZ_UT | "GMT" %TZ_GMT |
                      "EST" %TZ_EST | "EDT" %TZ_EDT |
                      "CST" %TZ_CST | "CDT" %TZ_CDT |
                      "MST" %TZ_MST | "MDT" %TZ_MDT |
                      "PST" %TZ_PST | "PDT" %TZ_PDT |
                      [a-iA-I] | [k-zK-Z];
-  time            =   time_of_day %DT_End (zone | obs_zone %Obs_Zone_End) FWS*;
+  time            =   time_of_day %DT_End FWS (zone | obs_zone %Obs_Zone_End) FWS*;
   date_time       =   (day_of_week ",")? date time;
 }%%
